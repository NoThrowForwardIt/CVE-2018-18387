# CVE-2018-18387
playSMS &lt; = 1.4.2 - Privilege escalation


TMHC TEAM has found a vulnerability that lead a priviledge escalation trought playSMS/web/init.php that can lead to a complete system compromise.

The attacker need to got an access on the box were playSMS is installed, must be able to edit playSMS related files, and the daemon must be run as root. Reading and working through the PHP, we realized what was going on. We saw references to a daemon, started looking for that, and read through what that was. We saw the daemon was installed to /usr/local/bin and it had associated files in /etc/init.d/.

We can run an ls and see that this daemon is running as root.

We cant edit the daemon directly, however, in that daemon file, we see there is a while loop being run every second.
Inside that loop is an include "init.php"; This file exists in the original /var/www/html/playsms, which means, this file should be editable.


The Developers is aware of the bug and consented to the release.

Fix:
never run the Daemon as root.

Playsms Contacts:
https://playsms.org 

https://github.com/antonraharja/playSMS
